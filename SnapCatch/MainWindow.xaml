<controls:MetroWindow x:Class="SnapCatch.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SnapCatch"
        xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
        xmlns:tb="http://www.hardcodet.net/taskbar"
        xmlns:additionalControl="clr-namespace:SnapCatch.AdditionalControl"
        mc:Ignorable="d"
        x:Name="MwndContainer"
        Title="{DynamicResource app_MainWindowName}" Height="600" Width="920" DataContext="{Binding Source={StaticResource Locator}, Path=Main}" 
                      Background="{DynamicResource ControlBackgroundBrush}">
    <Grid Background="{DynamicResource AccentColorBrush4}">
        <tb:TaskbarIcon IconSource="Resources/Icons/tray_ico.ico" 
                        DoubleClickCommand="{Binding RestoreWindowCommand}">
            <tb:TaskbarIcon.ContextMenu>
                <ContextMenu Background="{DynamicResource ControlBackgroundBrush}">
                    <ContextMenu.Items>
                        <MenuItem Command="{Binding DisplaySettings}" Header="Настройки"/>
                        <MenuItem Command="{Binding CloseAppCommand}" Header="Закрыть"/>
                    </ContextMenu.Items>
                </ContextMenu>
            </tb:TaskbarIcon.ContextMenu>
        </tb:TaskbarIcon>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="0"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="25"/>
            </Grid.RowDefinitions>
            <Grid ClipToBounds="False"  Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="40"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <ScrollViewer  Panel.ZIndex="0" HorizontalScrollBarVisibility="Auto" Grid.Column="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                    <Border Panel.ZIndex="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" BorderBrush="{DynamicResource AccentBaseColorBrush}">
                        <Border Panel.ZIndex="0"  VerticalAlignment="Center" HorizontalAlignment="Center" BorderThickness="1" BorderBrush="{DynamicResource AccentColorBrush}">
                            <Border.Effect>
                                <DropShadowEffect Direction="30" Opacity=".2" Color="{DynamicResource BlackColor}" ShadowDepth="7"></DropShadowEffect>
                            </Border.Effect>
                            <ItemsControl Panel.ZIndex="0" ItemsSource="{Binding DrawingLayers }">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <Canvas Panel.ZIndex="0" Width="{Binding Width}" Height="{Binding Height}">
                                            <Canvas.RenderTransform>
                                                <ScaleTransform ScaleX="{Binding WorkAreaScaleFactor}" CenterX="{Binding ImageCenterX}" CenterY="{Binding ImageCenterY}"></ScaleTransform>
                                            </Canvas.RenderTransform>
                                        </Canvas>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                            </ItemsControl>
                        </Border>
                    </Border>
                </ScrollViewer>
                <Canvas Grid.Column="0" Background="{DynamicResource ControlBackgroundBrush}">
                    <additionalControl:ExpandableButton Width="40" Height="40">
                        <additionalControl:ExpandableButton.AdditionalContent>
                            <DockPanel>
                                <Button Width="40" Content="A"></Button>
                                <Button Width="40" Content="B"></Button>
                                <Button Width="40" Content="C"></Button>
                                <Button Width="40" Content="D"></Button>
                            </DockPanel>
                        </additionalControl:ExpandableButton.AdditionalContent>
                    </additionalControl:ExpandableButton>
                    <additionalControl:ExpandableButton Canvas.Top="40" Width="40" Height="40"></additionalControl:ExpandableButton>
                </Canvas>
            </Grid>
            <StatusBar x:Name="StatusBar" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Grid.Row="2" Background="{DynamicResource AccentBaseColorBrush}">
                <DockPanel LastChildFill="True" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Width="{Binding ElementName=MwndContainer, Path=Width}">
                    <TextBlock  Margin="4,0,4,0" Text="100%" Background="{DynamicResource AccentColorBrush2}"></TextBlock>
                    <Slider Margin="0,0,16,0" TickPlacement="None" Foreground="{DynamicResource TextBoxBorderBrush}"  VerticalAlignment="Stretch" HorizontalAlignment="Stretch"
                            TickFrequency="10" Ticks="29" Minimum="0" Maximum="300" Style="{DynamicResource FlatSlider}"></Slider>
                </DockPanel>
            </StatusBar>
        </Grid>
    </Grid>
</controls:MetroWindow>

